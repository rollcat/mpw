{% macro button(action, label) -%}
  <div class="button">
    <form action="{{ action }}" method="post">
      <input value="{{ label }}" type="submit" />
    </form>
  </div>
{%- endmacro %}
{% macro time(i) -%}{{
  (i|int / 60)|int
  }}:{{
  "%02d"|format((i|int % 60))
  }}{%- endmacro %}
<!doctype HTML>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="flask" />
    {% block autorefresh %}
      {% if autorefresh > 0 %}
        <meta http-equiv="refresh" content="{{ autorefresh }}" />
      {% endif %}
    {% endblock %}
    <title>
      {% block title %}
        ùÑû {{ status_line }}
      {% endblock %}
    </title>
    <style>
      .playback         { padding: 10px; }
      .controls         { display: table; }
      .controls .button { display: table-cell; }
      thead tr td       { font-weight: bold; }
      tr.odd            { background-color: #fafafa; }
      tr#now            { background-color: #dadada; }
      tr:hover          { color: #444; }
    </style>
  </head>
  <body>
    <h1>ùÑû {{ status_line }}</h1>
    {% block control %}
      <div class="playback controls">
        {{ button("/controls/prev", symbols.controls.prev) }}
        {{ button("/controls/stop", symbols.controls.stop) }}
        {{ button("/controls/play-pause", symbols.controls["play-pause"]) }}
        {{ button("/controls/next", symbols.controls.next) }}
      </div>
    {% endblock %}
    {% block modes %}
      <div class="playback">
        <a href="/">Now Playing</a> ::
        <a href="/browse/">Browse Songs</a>
        <span class="breadcrumbs">
          {% for item in breadcrumbs %}
            /
            <a href="/browse{{ item.path }}">
              {{ item.label }}
            </a>
          {% endfor %}
        </span>
      </div>
    {% endblock %}
    {% block browse %}
    {% endblock %}
    {% block playlist %}
      <table>
        <thead>
          <td>Controls</td>
          <td>Artist</td>
          <td>Title</td>
          <td>Album</td>
          <td>Length</td>
        </thead>
        <tbody>
          {% for item in playlist %}
            <tr class="{{ loop.cycle('odd', 'even') }}"
                {% if item.pos == status.song %} id="now" {% endif %}
                >
              <td>
                <div class="controls">
                  {{ button("/playlist/play/" + item.pos,
                            symbols.controls.play) }}
                  {{ button("/playlist/delete/" + item.pos,
                            symbols.other.delete) }}
                </div>
              </td>
              <td>{{ item.artist     }}</td>
              <td>{{ item.title      }}</td>
              <td>{{ item.album      }}</td>
              <td>{{ time(item.time) }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <div class="playback controls">
        {{ button("/playlist/clear-old",
                  symbols.other.delete + " CLEAR OLD") }}
        {{ button("/playlist/shuffle",
                  symbols.other.refresh + " SHUFFLE") }}
      </div>
    {% endblock %}
    {% block settings %}
      <hr />
      <div class="controls">
        Quick settings!
        <span>Autorefresh
          {% if autorefresh > 0 %}
            {{ button("/settings/autorefresh/0", "Disable") }}
          {% else %}
            {{ button("/settings/autorefresh/30", "Enable (30s)") }}
          {% endif %}
        </span>
      </div>
    {% endblock %}
  </body>
</html>
{# -*- mode: jinja2; -*- #}
